(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{74094:function(e,s,l){Promise.resolve().then(l.bind(l,74300))},74300:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return f}});var a=l(57437),t=l(2265),n=l(66070),i=l(35974),r=l(47625),d=l(21156),o=l(56940),c=l(97059),u=l(62994),x=l(8147),m=l(54061),h=l(75169),j=l(3574),v=l(20407),g=l(77031),b=l(31699),p=l(63611);function f(){var e,s,l,f,N;let[y,w]=(0,t.useState)(null),[S,_]=(0,t.useState)(null),[O,k]=(0,t.useState)(null),[C,K]=(0,t.useState)(null),[R,Y]=(0,t.useState)(!1);async function Z(){Y(!0);try{let e=await fetch("/api/cepalab/analyze",{method:"POST"}),s=await e.json();K(s)}finally{Y(!1)}}(0,t.useEffect)(()=>{(async()=>{let e=await fetch("/api/cepalab/sales");w(await e.json());let s=await fetch("/api/cepalab/stock");_(await s.json());let l=await fetch("/api/cepalab/financial");k(await l.json())})()},[]);let B=((null==y?void 0:y.monthly)||[]).map(e=>({label:"".concat(String(e.mes).padStart(2,"0"),"/").concat(e.ano),vendas:Number(e.valor_total||0),pedidos:Number(e.total_vendas||0)})).reverse(),E=Object.entries(((null==O?void 0:O.receivables)||[]).reduce((e,s)=>{let l=s.Sit_nome||"N/A";return e[l]=(e[l]||0)+1,e},{})).map(e=>{let[s,l]=e;return{name:s,value:l}}),A=["#10b981","#f59e0b","#ef4444","#6366f1","#6b7280"];return(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold glow-orange",children:"Dashboard CEPALAB"}),(0,a.jsx)("button",{onClick:Z,className:"px-3 py-2 text-sm rounded-lg transition-colors bg-primary text-primary-foreground glow-border hover:bg-[#ff8a1f]",children:"Analisar com IA"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{className:"neu-card",children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-xs font-medium glow-orange",children:"Vendas Totais"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-xl font-bold glow-orange",children:["R$ ",Number((null==y?void 0:y.totalSales)||0).toLocaleString("pt-BR")]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[Number((null==y?void 0:y.totalOrders)||0)," pedidos"]})]})]}),(0,a.jsxs)(n.Zb,{className:"neu-card",children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-xs font-medium glow-orange",children:"Estoque Dispon\xedvel"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-xl font-bold glow-orange",children:Number((null==S?void 0:null===(e=S.summary)||void 0===e?void 0:e.total_disponivel)||0).toLocaleString("pt-BR")}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[Number((null==S?void 0:null===(s=S.summary)||void 0===s?void 0:s.produtos)||0)," produtos"]})]})]}),(0,a.jsxs)(n.Zb,{className:"neu-card",children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-xs font-medium glow-orange",children:"Contas Vencidas"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-xl font-bold glow-orange",children:["R$ ",Number((null==O?void 0:null===(l=O.overdue)||void 0===l?void 0:l.total)||0).toLocaleString("pt-BR")]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[Number((null==O?void 0:null===(f=O.overdue)||void 0===f?void 0:f.qtd)||0)," t\xedtulos"]})]})]}),(0,a.jsxs)(n.Zb,{className:"neu-card",children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-xs font-medium glow-orange",children:"Estoque Negativo"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-xl font-bold glow-orange",children:Number((null==S?void 0:null===(N=S.negatives)||void 0===N?void 0:N.length)||0)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"produtos com falta"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{className:"flex items-center gap-2",children:"Vendas por M\xeas"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)(r.h,{width:"100%",height:300,children:(0,a.jsxs)(d.w,{data:B,children:[(0,a.jsx)(o.q,{strokeDasharray:"3 3"}),(0,a.jsx)(c.K,{dataKey:"label"}),(0,a.jsx)(u.B,{}),(0,a.jsx)(x.u,{}),(0,a.jsx)(m.x,{type:"monotone",dataKey:"vendas",stroke:"#3b82f6"}),(0,a.jsx)(m.x,{type:"monotone",dataKey:"pedidos",stroke:"#10b981"})]})})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{className:"flex items-center gap-2",children:"Contas por Status"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)(r.h,{width:"100%",height:300,children:(0,a.jsxs)(h.u,{children:[(0,a.jsx)(j.b,{data:E,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,children:E.map((e,s)=>(0,a.jsx)(v.b,{fill:A[s%A.length]},s))}),(0,a.jsx)(x.u,{})]})})})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Top Clientes"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)(r.h,{width:"100%",height:300,children:(0,a.jsxs)(g.v,{data:((null==y?void 0:y.topClients)||[]).map(e=>({name:e.nome_cliente,valor:Number(e.valor_total||0)})),children:[(0,a.jsx)(o.q,{strokeDasharray:"3 3"}),(0,a.jsx)(c.K,{dataKey:"name",hide:!0}),(0,a.jsx)(u.B,{}),(0,a.jsx)(x.u,{}),(0,a.jsx)(b.$,{dataKey:"valor",fill:"#6366f1"})]})})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Caixas"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-2",children:((null==O?void 0:O.cashboxes)||[]).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.nome}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.situacao})]}),(0,a.jsxs)(i.C,{className:0>Number(e.saldo_atual_total)?"bg-red-100 text-red-800":"bg-green-100 text-green-800",children:["R$ ",Number(e.saldo_atual_total||0).toLocaleString("pt-BR")]})]},s))})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(p.J,{aiSummary:(null==C?void 0:C.aiSummary)||"",analysis:(null==C?void 0:C.analysis)||null,vulns:(null==C?void 0:C.vulns)||null,kpis:(null==C?void 0:C.kpis)||null,securityMetrics:(null==C?void 0:C.securityMetrics)||null,performanceMetrics:(null==C?void 0:C.performanceMetrics)||null,onRegenerate:Z,isLoading:R})})]})}},94508:function(e,s,l){"use strict";l.d(s,{cn:function(){return n}});var a=l(61994),t=l(53335);function n(){for(var e=arguments.length,s=Array(e),l=0;l<e;l++)s[l]=arguments[l];return(0,t.m6)((0,a.W)(s))}}},function(e){e.O(0,[467,682,156,611,971,117,744],function(){return e(e.s=74094)}),_N_E=e.O()}]);