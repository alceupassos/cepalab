(()=>{var e={};e.id=5113,e.ids=[5113],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},9714:e=>{"use strict";e.exports=require("constants")},84770:e=>{"use strict";e.exports=require("crypto")},18139:e=>{"use strict";e.exports=require("dgram")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6005:e=>{"use strict";e.exports=require("node:crypto")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},70612:e=>{"use strict";e.exports=require("node:os")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},87529:()=>{},51837:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>_,patchFetch:()=>O,requestAsyncStorage:()=>x,routeModule:()=>v,serverHooks:()=>m,staticGenerationAsyncStorage:()=>q});var s={};t.r(s),t.d(s,{GET:()=>S,dynamic:()=>d,runtime:()=>l});var o=t(49303),a=t(88716),i=t(60670),u=t(87070),n=t(59924),c=t.n(n),p=t(94005);let l="nodejs",d="force-dynamic";async function S(){try{let e=function(){let e=process.env.MSSQL_SERVER,r=process.env.MSSQL_PORT?Number(process.env.MSSQL_PORT):void 0,t=process.env.MSSQL_DATABASE,s=process.env.MSSQL_USER,o=process.env.MSSQL_PASSWORD;return e&&r&&t&&s&&o?{server:e,port:r,database:t,user:s,password:o}:(0,p.k)()||null}();if(!e)return u.NextResponse.json({error:"Credenciais MSSQL n\xe3o configuradas"},{status:400});let r={server:e.server,port:Number(e.port),user:e.user,password:e.password,database:e.database,options:{encrypt:!1,trustServerCertificate:!0},connectionTimeout:15e3,requestTimeout:2e4,pool:{max:5,min:0,idleTimeoutMillis:3e4}},t=await c().connect(r),s=await t.request().query("SELECT COUNT(*) AS total_vendas, SUM(valor_total) AS valor_total FROM v_venda WITH (NOLOCK)"),o=await t.request().query(`SELECT YEAR(data) AS ano, MONTH(data) AS mes, COUNT(*) AS total_vendas, SUM(valor_total) AS valor_total
       FROM v_venda WITH (NOLOCK)
       WHERE data >= DATEADD(MONTH, -12, GETDATE())
       GROUP BY YEAR(data), MONTH(data)
       ORDER BY ano DESC, mes DESC`),a=await t.request().query(`SELECT TOP 10 codigo_cliente, nome_cliente, COUNT(*) AS total_compras, SUM(valor_total) AS valor_total
       FROM v_venda WITH (NOLOCK)
       GROUP BY codigo_cliente, nome_cliente
       ORDER BY valor_total DESC`),i=await t.request().query(`SELECT nome_vendedor, COUNT(*) AS total_vendas, SUM(valor_total) AS valor_total
       FROM v_venda WITH (NOLOCK)
       GROUP BY nome_vendedor
       ORDER BY valor_total DESC`);return await t.close(),u.NextResponse.json({totalSales:Number(s.recordset?.[0]?.valor_total||0),totalOrders:Number(s.recordset?.[0]?.total_vendas||0),monthly:o.recordset,topClients:a.recordset,bySeller:i.recordset})}catch(e){return u.NextResponse.json({error:e?.message??String(e)},{status:500})}}let v=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/cepalab/sales/route",pathname:"/api/cepalab/sales",filename:"route",bundlePath:"app/api/cepalab/sales/route"},resolvedPagePath:"/Users/alceualvespasssosmac/cepalab/app/api/cepalab/sales/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:q,serverHooks:m}=v,_="/api/cepalab/sales/route";function O(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:q})}},94005:(e,r,t)=>{"use strict";t.d(r,{k:()=>u});var s=t(92048),o=t.n(s),a=t(55315),i=t.n(a);function u(){for(let e of[i().join(process.cwd(),"docs","conexao-sql-sgc-md.md"),i().join(process.cwd(),"docs","conex\xe3o-sql-sgc-md.md"),i().join(process.cwd(),"docs","conexao-sql-sgc.md"),i().join(process.cwd(),"docs","Conexao_SQL_Server_Gerador.md")])try{if(!o().existsSync(e))continue;let r=o().readFileSync(e,"utf-8").split(/\r?\n/),t=e=>{let t=RegExp(`${e}s*[:=]s*(.+)`,"i"),s=r.find(e=>t.test(e));return s?s.match(t)[1].trim():void 0},s=t("Servidor")||t("MSSQL_SERVER"),a=t("Porta")||t("MSSQL_PORT"),i=t("Database")||t("MSSQL_DATABASE"),u=t("Usu\xe1rio")||t("MSSQL_USER"),n=t("Senha")||t("MSSQL_PASSWORD");if(s&&a&&i&&u)return{server:s,port:Number(a),database:i,user:u,password:n}}catch{}return null}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,9924],()=>t(51837));module.exports=s})();